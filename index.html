<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HydroPals üíß</title>
<link href="https://fonts.googleapis.com/css2?family=Righteous&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --deep: #0a1628;
    --ocean: #0d3b6e;
    --wave: #1a6fad;
    --sky: #38b6ff;
    --foam: #a8e6ff;
    --mint: #00e5c3;
    --sun: #ffe066;
    --coral: #ff6b6b;
    --white: #f0faff;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Nunito', sans-serif;
    background: var(--deep);
    color: var(--white);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Animated background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: 
      radial-gradient(ellipse at 20% 50%, rgba(26, 111, 173, 0.3) 0%, transparent 60%),
      radial-gradient(ellipse at 80% 20%, rgba(0, 229, 195, 0.15) 0%, transparent 50%),
      radial-gradient(ellipse at 60% 80%, rgba(56, 182, 255, 0.1) 0%, transparent 50%);
    pointer-events: none;
    z-index: 0;
  }

  .bubbles {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 0;
    overflow: hidden;
  }

  .bubble {
    position: absolute;
    border-radius: 50%;
    background: rgba(56, 182, 255, 0.08);
    border: 1px solid rgba(56, 182, 255, 0.15);
    animation: floatUp linear infinite;
    bottom: -100px;
  }

  @keyframes floatUp {
    0% { transform: translateY(0) scale(1); opacity: 0; }
    10% { opacity: 1; }
    90% { opacity: 0.5; }
    100% { transform: translateY(-110vh) scale(1.2); opacity: 0; }
  }

  .container {
    position: relative;
    z-index: 1;
    max-width: 480px;
    margin: 0 auto;
    padding: 20px 16px 60px;
  }

  /* Header */
  header {
    text-align: center;
    padding: 30px 0 20px;
  }

  .logo {
    font-family: 'Righteous', cursive;
    font-size: 2.8rem;
    background: linear-gradient(135deg, var(--sky), var(--mint));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    letter-spacing: 2px;
  }

  .tagline {
    color: var(--foam);
    font-size: 0.85rem;
    opacity: 0.7;
    margin-top: 4px;
    letter-spacing: 1px;
    text-transform: uppercase;
  }

  /* Screen management */
  .screen { display: none; }
  .screen.active { display: block; }

  /* Name setup */
  .setup-card {
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(56, 182, 255, 0.2);
    border-radius: 24px;
    padding: 32px 24px;
    text-align: center;
    backdrop-filter: blur(10px);
    margin-top: 20px;
  }

  .setup-card h2 {
    font-family: 'Righteous', cursive;
    font-size: 1.6rem;
    color: var(--sky);
    margin-bottom: 8px;
  }

  .setup-card p { color: var(--foam); opacity: 0.8; margin-bottom: 24px; }

  input[type="text"] {
    width: 100%;
    background: rgba(255,255,255,0.08);
    border: 2px solid rgba(56, 182, 255, 0.3);
    border-radius: 14px;
    padding: 14px 18px;
    font-size: 1.1rem;
    font-family: 'Nunito', sans-serif;
    color: var(--white);
    outline: none;
    transition: border-color 0.3s;
    margin-bottom: 16px;
  }

  input[type="text"]::placeholder { color: rgba(168, 230, 255, 0.4); }
  input[type="text"]:focus { border-color: var(--sky); }

  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 14px 28px;
    border-radius: 50px;
    border: none;
    font-family: 'Nunito', sans-serif;
    font-size: 1rem;
    font-weight: 800;
    cursor: pointer;
    transition: all 0.2s;
    text-decoration: none;
  }

  .btn:active { transform: scale(0.96); }

  .btn-primary {
    background: linear-gradient(135deg, var(--sky), var(--mint));
    color: var(--deep);
    width: 100%;
    font-size: 1.1rem;
    letter-spacing: 0.5px;
  }

  .btn-primary:hover { box-shadow: 0 8px 30px rgba(56, 182, 255, 0.4); transform: translateY(-1px); }

  .btn-outline {
    background: transparent;
    border: 2px solid rgba(56, 182, 255, 0.4);
    color: var(--sky);
    font-size: 0.9rem;
    padding: 10px 20px;
  }

  .btn-outline:hover { border-color: var(--sky); background: rgba(56, 182, 255, 0.1); }

  .btn-ghost {
    background: rgba(255,255,255,0.06);
    color: var(--foam);
    font-size: 0.85rem;
    padding: 10px 18px;
  }

  /* Goal picker */
  .goal-picker {
    display: flex;
    gap: 8px;
    justify-content: center;
    margin-bottom: 12px;
    flex-wrap: wrap;
  }

  .goal-opt {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    border: 2px solid rgba(56,182,255,0.3);
    background: rgba(255,255,255,0.05);
    color: var(--foam);
    font-family: 'Nunito', sans-serif;
    font-size: 0.95rem;
    font-weight: 800;
    cursor: pointer;
    transition: all 0.2s;
  }

  .goal-opt:hover { border-color: var(--sky); color: var(--sky); }

  .goal-opt.active {
    background: linear-gradient(135deg, var(--sky), var(--mint));
    border-color: transparent;
    color: var(--deep);
    box-shadow: 0 4px 14px rgba(56,182,255,0.35);
  }

  /* Progress ring */
  .progress-ring-wrap {
    position: relative;
    width: 180px;
    height: 180px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
  }

  .progress-ring-svg {
    position: absolute;
    top: 0; left: 0;
    transform: rotate(-90deg);
  }

  .progress-ring-track {
    fill: none;
    stroke: rgba(56,182,255,0.12);
    stroke-width: 6;
  }

  .progress-ring-fill {
    fill: none;
    stroke: url(#ringGrad);
    stroke-width: 6;
    stroke-linecap: round;
    transition: stroke-dashoffset 0.5s ease;
  }

  .progress-ring-fill.goal-done {
    stroke: url(#ringGradDone);
  }

  /* Goal change in settings */
  .goal-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 6px;
  }

  .goal-label { font-size:0.85rem; color: var(--foam); opacity:0.8; }
  .goal-value { font-size:1.1rem; font-weight:800; color:var(--sky); }

  /* Month grid */
  .month-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 4px;
  }

  .month-day {
    aspect-ratio: 1;
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.6rem;
    font-weight: 700;
    color: rgba(255,255,255,0.25);
    background: rgba(255,255,255,0.04);
    border: 1px solid rgba(56,182,255,0.08);
    transition: all 0.3s;
    position: relative;
  }

  .month-day.filled {
    background: linear-gradient(135deg, var(--wave), var(--sky));
    color: white;
    border-color: transparent;
    box-shadow: 0 2px 8px rgba(56,182,255,0.25);
  }

  .month-day.today {
    border-color: var(--sky);
    color: var(--sky);
  }

  .month-day.today.filled {
    background: linear-gradient(135deg, var(--mint), #38b6ff);
    border-color: transparent;
    color: var(--deep);
    box-shadow: 0 2px 12px rgba(0,229,195,0.4);
  }

  .month-day.future {
    opacity: 0.3;
  }

  .month-day-header {
    font-size: 0.55rem;
    font-weight: 800;
    color: rgba(168,230,255,0.4);
    text-align: center;
    padding-bottom: 4px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  /* Notification toggle */
  .notif-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 14px;
  }

  .toggle {
    position: relative;
    width: 48px;
    height: 26px;
    flex-shrink: 0;
  }

  .toggle input { opacity: 0; width: 0; height: 0; }

  .toggle-slider {
    position: absolute;
    inset: 0;
    background: rgba(255,255,255,0.1);
    border-radius: 50px;
    cursor: pointer;
    transition: 0.3s;
    border: 1px solid rgba(56,182,255,0.2);
  }

  .toggle-slider::before {
    content: '';
    position: absolute;
    width: 20px;
    height: 20px;
    left: 2px;
    top: 2px;
    background: white;
    border-radius: 50%;
    transition: 0.3s;
  }

  .toggle input:checked + .toggle-slider {
    background: linear-gradient(135deg, var(--sky), var(--mint));
    border-color: transparent;
  }

  .toggle input:checked + .toggle-slider::before {
    transform: translateX(22px);
  }

  .time-picker-row {
    display: flex;
    gap: 8px;
    align-items: center;
    margin-top: 12px;
  }

  input[type="time"] {
    background: rgba(255,255,255,0.08);
    border: 2px solid rgba(56,182,255,0.3);
    border-radius: 12px;
    padding: 10px 14px;
    font-size: 1rem;
    font-family: 'Nunito', sans-serif;
    color: var(--white);
    outline: none;
    flex: 1;
    transition: border-color 0.3s;
  }

  input[type="time"]:focus { border-color: var(--sky); }
  input[type="time"]::-webkit-calendar-picker-indicator { filter: invert(1); opacity: 0.5; }

  /* Main dashboard */
  .user-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 20px;
  }

  .user-greeting { font-size: 0.9rem; color: var(--foam); opacity: 0.7; }
  .user-name { font-size: 1.2rem; font-weight: 800; color: var(--white); }

  .points-badge {
    background: linear-gradient(135deg, var(--sun), #ffb347);
    color: var(--deep);
    border-radius: 50px;
    padding: 6px 16px;
    font-weight: 800;
    font-size: 0.95rem;
    display: flex;
    align-items: center;
    gap: 4px;
  }

  /* Big drink button */
  .drink-section {
    text-align: center;
    margin: 10px 0 24px;
  }

  .drink-btn-wrap {
    position: relative;
    display: inline-block;
  }

  .drink-btn {
    width: 180px;
    height: 180px;
    border-radius: 50%;
    border: none;
    background: linear-gradient(145deg, var(--wave), var(--sky));
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 0 0 rgba(56, 182, 255, 0.4), 0 20px 60px rgba(26, 111, 173, 0.5);
    position: relative;
    overflow: hidden;
  }

  .drink-btn::before {
    content: '';
    position: absolute;
    bottom: -20px;
    left: -20px;
    right: -20px;
    height: 60px;
    background: rgba(255,255,255,0.15);
    border-radius: 50%;
    animation: waveAnim 2s ease-in-out infinite;
  }

  @keyframes waveAnim {
    0%, 100% { transform: translateY(0) scaleX(1); }
    50% { transform: translateY(-8px) scaleX(1.05); }
  }

  .drink-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 0 0 16px rgba(56, 182, 255, 0.12), 0 20px 60px rgba(26, 111, 173, 0.6);
  }

  .drink-btn:active { transform: scale(0.95); }

  .drink-btn.checked-today {
    background: linear-gradient(145deg, #1a7a5e, var(--mint));
  }

  .drink-btn-icon { font-size: 3.5rem; line-height: 1; }
  .drink-btn-label {
    font-family: 'Righteous', cursive;
    font-size: 0.85rem;
    letter-spacing: 1px;
    margin-top: 6px;
    color: rgba(255,255,255,0.9);
  }

  .drink-status {
    margin-top: 14px;
    font-size: 0.95rem;
    color: var(--foam);
    opacity: 0.7;
    min-height: 24px;
  }

  /* Streak */
  .streak-row {
    display: flex;
    gap: 8px;
    justify-content: center;
    margin-bottom: 6px;
  }

  .streak-dot {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.65rem;
    font-weight: 700;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    border: 2px solid rgba(56, 182, 255, 0.2);
    color: rgba(255,255,255,0.3);
    transition: all 0.3s;
  }

  .streak-dot.filled {
    background: linear-gradient(135deg, var(--sky), var(--mint));
    border-color: transparent;
    color: var(--deep);
    box-shadow: 0 4px 12px rgba(56, 182, 255, 0.35);
  }

  .streak-dot.today-dot {
    border-color: var(--sky);
    color: var(--sky);
  }

  /* Stats card */
  .card {
    background: rgba(255,255,255,0.04);
    border: 1px solid rgba(56, 182, 255, 0.15);
    border-radius: 20px;
    padding: 20px;
    margin-bottom: 16px;
    backdrop-filter: blur(10px);
  }

  .card-title {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    color: var(--sky);
    margin-bottom: 14px;
    font-weight: 700;
  }

  /* Weekly chart */
  .week-chart {
    display: flex;
    align-items: flex-end;
    gap: 8px;
    height: 80px;
    justify-content: space-between;
  }

  .day-bar-wrap {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    height: 100%;
    justify-content: flex-end;
  }

  .day-bar {
    width: 100%;
    border-radius: 6px 6px 0 0;
    background: rgba(56, 182, 255, 0.15);
    min-height: 4px;
    transition: height 0.5s ease;
    position: relative;
    overflow: hidden;
  }

  .day-bar.has-data {
    background: linear-gradient(to top, var(--wave), var(--sky));
    box-shadow: 0 0 10px rgba(56, 182, 255, 0.3);
  }

  .day-bar.today-bar { background: linear-gradient(to top, var(--mint), #7fffea); }

  .day-label {
    font-size: 0.65rem;
    font-weight: 700;
    color: rgba(255,255,255,0.4);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .day-label.today-label { color: var(--mint); }

  /* Friends */
  .friends-list { display: flex; flex-direction: column; gap: 10px; }

  .friend-row {
    display: flex;
    align-items: center;
    gap: 12px;
    background: rgba(255,255,255,0.04);
    border-radius: 14px;
    padding: 12px 14px;
    border: 1px solid rgba(56, 182, 255, 0.1);
  }

  .friend-avatar {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--ocean), var(--wave));
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    border: 2px solid rgba(56,182,255,0.3);
    flex-shrink: 0;
  }

  .friend-name { font-weight: 700; font-size: 0.95rem; flex: 1; }
  .friend-pts {
    font-size: 0.8rem;
    color: var(--sun);
    font-weight: 700;
  }
  .friend-streak { font-size: 0.75rem; color: var(--foam); opacity: 0.6; }
  .friend-checked { font-size: 1.1rem; }

  .empty-friends {
    text-align: center;
    padding: 20px;
    color: var(--foam);
    opacity: 0.5;
    font-size: 0.9rem;
  }

  /* Invite */
  .invite-row {
    display: flex;
    gap: 8px;
    margin-top: 12px;
  }

  .invite-link-box {
    flex: 1;
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(56, 182, 255, 0.2);
    border-radius: 12px;
    padding: 10px 14px;
    font-size: 0.78rem;
    color: var(--foam);
    word-break: break-all;
    font-family: monospace;
    user-select: all;
    cursor: text;
  }

  .btn-copy {
    background: rgba(56, 182, 255, 0.15);
    border: 1px solid rgba(56, 182, 255, 0.3);
    border-radius: 12px;
    color: var(--sky);
    font-size: 0.85rem;
    font-weight: 700;
    padding: 10px 14px;
    cursor: pointer;
    font-family: 'Nunito', sans-serif;
    transition: all 0.2s;
    white-space: nowrap;
  }

  .btn-copy:hover { background: rgba(56, 182, 255, 0.25); }
  .btn-copy:active { transform: scale(0.95); }

  /* Affirmation popup */
  .affirmation-overlay {
    position: fixed;
    inset: 0;
    background: rgba(10, 22, 40, 0.85);
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
    backdrop-filter: blur(4px);
  }

  .affirmation-overlay.show {
    opacity: 1;
    pointer-events: all;
  }

  .affirmation-card {
    background: linear-gradient(145deg, var(--ocean), #0a2440);
    border: 1px solid rgba(56, 182, 255, 0.4);
    border-radius: 28px;
    padding: 40px 28px;
    text-align: center;
    max-width: 340px;
    width: 100%;
    transform: scale(0.8);
    transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 30px 80px rgba(0,0,0,0.5);
  }

  .affirmation-overlay.show .affirmation-card { transform: scale(1); }

  .affirmation-emoji { font-size: 4rem; margin-bottom: 16px; display: block; animation: bounce 0.6s ease 0.3s both; }

  @keyframes bounce {
    0% { transform: scale(0); }
    60% { transform: scale(1.2); }
    100% { transform: scale(1); }
  }

  .affirmation-points {
    display: inline-block;
    background: linear-gradient(135deg, var(--sun), #ffb347);
    color: var(--deep);
    border-radius: 50px;
    padding: 4px 16px;
    font-weight: 800;
    font-size: 1rem;
    margin-bottom: 16px;
  }

  .affirmation-text {
    font-size: 1.3rem;
    font-weight: 800;
    line-height: 1.4;
    color: var(--white);
    margin-bottom: 8px;
  }

  .affirmation-sub {
    font-size: 0.9rem;
    color: var(--foam);
    opacity: 0.7;
    margin-bottom: 28px;
  }

  /* Nav */
  .nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(10, 22, 40, 0.95);
    border-top: 1px solid rgba(56, 182, 255, 0.15);
    display: flex;
    justify-content: space-around;
    padding: 10px 0 16px;
    z-index: 50;
    backdrop-filter: blur(16px);
  }

  .nav-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 3px;
    background: none;
    border: none;
    cursor: pointer;
    color: rgba(168, 230, 255, 0.4);
    transition: color 0.2s;
    font-family: 'Nunito', sans-serif;
    padding: 4px 16px;
  }

  .nav-btn.active { color: var(--sky); }
  .nav-btn-icon { font-size: 1.4rem; }
  .nav-btn-label { font-size: 0.65rem; font-weight: 700; letter-spacing: 0.5px; text-transform: uppercase; }

  /* Sections within main screen */
  .section { margin-bottom: 20px; }

  /* Confetti canvas */
  #confetti-canvas {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 200;
  }

  /* Join screen */
  .join-info {
    background: rgba(56, 182, 255, 0.1);
    border: 1px solid rgba(56, 182, 255, 0.2);
    border-radius: 14px;
    padding: 14px;
    text-align: center;
    margin-bottom: 16px;
  }

  .join-inviter { font-size: 1.1rem; font-weight: 800; color: var(--sky); }

  /* Responsive */
  @media (max-width: 360px) {
    .drink-btn { width: 150px; height: 150px; }
    .logo { font-size: 2.2rem; }
  }
</style>
</head>
<body>

<div class="bubbles" id="bubbles"></div>
<canvas id="confetti-canvas"></canvas>

<div class="container">
  <header>
    <div class="logo">üíß HydroPals</div>
    <div class="tagline">Drink together. Stay legendary.</div>
  </header>

  <!-- SETUP SCREEN -->
  <div class="screen active" id="screen-setup">
    <div class="setup-card">
      <h2>Welcome, friend! üëã</h2>
      <p>What should we call you?</p>
      <input type="text" id="setup-name" placeholder="Your name..." maxlength="24" />
      <p style="margin-bottom:10px;margin-top:-8px">Daily water goal:</p>
      <div class="goal-picker" id="setup-goal-picker">
        <button class="goal-opt" data-val="4" onclick="selectGoal(this)">4</button>
        <button class="goal-opt active" data-val="6" onclick="selectGoal(this)">6</button>
        <button class="goal-opt" data-val="8" onclick="selectGoal(this)">8</button>
        <button class="goal-opt" data-val="10" onclick="selectGoal(this)">10</button>
        <button class="goal-opt" data-val="12" onclick="selectGoal(this)">12</button>
      </div>
      <div style="font-size:0.78rem;color:var(--foam);opacity:0.6;margin-bottom:20px;margin-top:-4px">glasses per day</div>
      <button class="btn btn-primary" onclick="setupUser()">
        üíß Start Hydrating
      </button>
    </div>
  </div>

  <!-- JOIN SCREEN (when invited) -->
  <div class="screen" id="screen-join">
    <div class="setup-card">
      <span style="font-size:3rem">ü§ù</span>
      <h2 style="margin-top:12px">You're invited!</h2>
      <div class="join-info">
        <div id="join-inviter-name" class="join-inviter"></div>
        <div style="font-size:0.85rem;color:var(--foam);opacity:0.7;margin-top:4px">wants you to join their hydration crew</div>
      </div>
      <p style="margin-bottom:20px">Enter your name to join and start earning points together!</p>
      <input type="text" id="join-name" placeholder="Your name..." maxlength="24" />
      <p style="margin-bottom:10px;margin-top:-8px">Daily water goal:</p>
      <div class="goal-picker" id="join-goal-picker">
        <button class="goal-opt" data-val="4" onclick="selectGoal(this)">4</button>
        <button class="goal-opt active" data-val="6" onclick="selectGoal(this)">6</button>
        <button class="goal-opt" data-val="8" onclick="selectGoal(this)">8</button>
        <button class="goal-opt" data-val="10" onclick="selectGoal(this)">10</button>
        <button class="goal-opt" data-val="12" onclick="selectGoal(this)">12</button>
      </div>
      <div style="font-size:0.78rem;color:var(--foam);opacity:0.6;margin-bottom:20px;margin-top:-4px">glasses per day</div>
      <button class="btn btn-primary" onclick="joinUser()">
        üíß Join the Crew
      </button>
    </div>
  </div>

  <!-- MAIN SCREEN -->
  <div class="screen" id="screen-main">
    <!-- Dashboard tab -->
    <div id="tab-home" class="tab-content">
      <div class="user-bar">
        <div>
          <div class="user-greeting">Hey there,</div>
          <div class="user-name" id="display-name">‚Äì</div>
        </div>
        <div class="points-badge">‚≠ê <span id="display-points">0</span> pts</div>
      </div>

      <!-- Month view -->
      <div class="card section">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px">
          <div class="card-title" style="margin-bottom:0">üî• This Month</div>
          <div style="font-size:0.82rem;color:var(--foam);opacity:0.65" id="streak-label"></div>
        </div>
        <div class="month-grid" id="month-grid"></div>
      </div>

      <!-- Drink button -->
      <div class="drink-section">
        <div class="progress-ring-wrap">
          <svg class="progress-ring-svg" width="180" height="180" viewBox="0 0 180 180">
            <defs>
              <linearGradient id="ringGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#38b6ff"/>
                <stop offset="100%" style="stop-color:#00e5c3"/>
              </linearGradient>
              <linearGradient id="ringGradDone" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#00e5c3"/>
                <stop offset="100%" style="stop-color:#ffe066"/>
              </linearGradient>
            </defs>
            <circle class="progress-ring-track" cx="90" cy="90" r="84"/>
            <circle class="progress-ring-fill" id="progress-ring-fill" cx="90" cy="90" r="84"
              stroke-dasharray="527.8"
              stroke-dashoffset="527.8"/>
          </svg>
          <button class="drink-btn" id="drink-btn" onclick="logDrink()">
            <span class="drink-btn-icon" id="drink-btn-icon">üíß</span>
            <span class="drink-btn-label" id="drink-btn-label">LOG DRINK</span>
          </button>
        </div>
        <div class="drink-status" id="drink-status"></div>
        <div style="margin-top:6px;font-size:0.8rem;color:var(--foam);opacity:0.5" id="goal-hint"></div>
      </div>
    </div>

    <!-- Stats tab -->
    <div id="tab-stats" class="tab-content" style="display:none">
      <div class="card section">
        <div class="card-title">üìä This Week</div>
        <div class="week-chart" id="week-chart"></div>
      </div>
      <div class="card section">
        <div style="display:flex;justify-content:space-between;margin-bottom:4px">
          <div>
            <div style="font-size:0.75rem;color:var(--sky);text-transform:uppercase;letter-spacing:1px;font-weight:700">Total Points</div>
            <div style="font-size:2rem;font-weight:800;color:var(--sun)" id="stat-total-pts">0</div>
          </div>
          <div style="text-align:right">
            <div style="font-size:0.75rem;color:var(--sky);text-transform:uppercase;letter-spacing:1px;font-weight:700">Total Drinks</div>
            <div style="font-size:2rem;font-weight:800;color:var(--mint)" id="stat-total-drinks">0</div>
          </div>
        </div>
        <div style="display:flex;justify-content:space-between;margin-top:14px;padding-top:14px;border-top:1px solid rgba(56,182,255,0.1)">
          <div>
            <div style="font-size:0.75rem;color:var(--sky);text-transform:uppercase;letter-spacing:1px;font-weight:700">Best Streak</div>
            <div style="font-size:1.5rem;font-weight:800;color:var(--coral)" id="stat-best-streak">0 days</div>
          </div>
          <div style="text-align:right">
            <div style="font-size:0.75rem;color:var(--sky);text-transform:uppercase;letter-spacing:1px;font-weight:700">Current Streak</div>
            <div style="font-size:1.5rem;font-weight:800;color:var(--foam)" id="stat-cur-streak">0 days</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Friends tab -->
    <div id="tab-friends" class="tab-content" style="display:none">
      <div class="card section">
        <div class="card-title">üèÜ Crew Leaderboard</div>
        <div class="friends-list" id="friends-list">
          <div class="empty-friends">No friends yet ‚Äî invite someone!</div>
        </div>
      </div>

      <div class="card section">
        <div class="card-title">üì® Invite a Friend</div>
        <p style="font-size:0.85rem;color:var(--foam);opacity:0.7;margin-bottom:12px">Share your unique link ‚Äî when they join, they'll automatically be in your crew!</p>
        <div class="invite-row">
          <div class="invite-link-box" id="invite-link-display">Generating...</div>
          <button class="btn-copy" id="copy-btn" onclick="copyInviteLink()">Copy</button>
        </div>
        <button class="btn btn-outline" style="width:100%;margin-top:10px" onclick="shareInvite()">üì§ Share</button>
      </div>
    </div>

    <!-- Settings tab -->
    <div id="tab-settings" class="tab-content" style="display:none">
      <div class="card section">
        <div class="card-title">üéØ Daily Goal</div>
        <div class="goal-row">
          <div class="goal-label">Target glasses per day</div>
          <div class="goal-value" id="settings-goal-val">8</div>
        </div>
        <div class="goal-picker" id="settings-goal-picker" style="justify-content:flex-start;margin-top:12px">
          <button class="goal-opt" data-val="4" onclick="selectGoal(this)">4</button>
          <button class="goal-opt" data-val="6" onclick="selectGoal(this)">6</button>
          <button class="goal-opt" data-val="8" onclick="selectGoal(this)">8</button>
          <button class="goal-opt" data-val="10" onclick="selectGoal(this)">10</button>
          <button class="goal-opt" data-val="12" onclick="selectGoal(this)">12</button>
        </div>
        <div style="font-size:0.8rem;color:var(--foam);opacity:0.6;margin-top:8px">Your streak counts when you hit your daily goal ‚úÖ</div>
      </div>
      <div class="card section">
        <div class="card-title">üë§ Profile</div>
        <div style="font-size:0.9rem;color:var(--foam);opacity:0.7">Logged in as</div>
        <div style="font-size:1.2rem;font-weight:800;margin-top:2px" id="settings-name-display"></div>
      </div>

      <div class="card section">
        <div class="card-title">üîî Reminders</div>
        <div class="notif-row">
          <div>
            <div style="font-weight:700;font-size:0.95rem">Daily reminder</div>
            <div style="font-size:0.8rem;color:var(--foam);opacity:0.65;margin-top:2px">Get nudged to drink water</div>
          </div>
          <label class="toggle">
            <input type="checkbox" id="notif-toggle" onchange="toggleNotifications(this)">
            <span class="toggle-slider"></span>
          </label>
        </div>
        <div id="notif-time-section" style="display:none">
          <div style="font-size:0.82rem;color:var(--foam);opacity:0.7;margin-bottom:8px">Remind me at:</div>
          <div class="time-picker-row">
            <input type="time" id="notif-time-1" value="09:00" onchange="saveNotifTimes()">
            <input type="time" id="notif-time-2" value="14:00" onchange="saveNotifTimes()">
            <input type="time" id="notif-time-3" value="19:00" onchange="saveNotifTimes()">
          </div>
          <div style="font-size:0.75rem;color:var(--foam);opacity:0.5;margin-top:8px">Morning ¬∑ Afternoon ¬∑ Evening</div>
        </div>
        <div id="notif-status" style="font-size:0.8rem;margin-top:10px;color:var(--mint);display:none"></div>
        <div style="font-size:0.75rem;color:var(--foam);opacity:0.45;margin-top:10px;line-height:1.4">‚ö†Ô∏è Notifications require the browser/tab to be open. For phone alerts, add this site to your Home Screen (Share ‚Üí Add to Home Screen on iOS).</div>
      </div>
    </div>

  </div>
</div>

<!-- Bottom Nav -->
<nav class="nav" id="main-nav" style="display:none">
  <button class="nav-btn active" onclick="showTab('home', this)">
    <span class="nav-btn-icon">üíß</span>
    <span class="nav-btn-label">Home</span>
  </button>
  <button class="nav-btn" onclick="showTab('stats', this)">
    <span class="nav-btn-icon">üìä</span>
    <span class="nav-btn-label">Stats</span>
  </button>
  <button class="nav-btn" onclick="showTab('friends', this)">
    <span class="nav-btn-icon">üë•</span>
    <span class="nav-btn-label">Crew</span>
  </button>
  <button class="nav-btn" onclick="showTab('settings', this)">
    <span class="nav-btn-icon">‚öôÔ∏è</span>
    <span class="nav-btn-label">Goals</span>
  </button>
</nav>

<!-- Affirmation Overlay -->
<div class="affirmation-overlay" id="affirmation-overlay" onclick="closeAffirmation()">
  <div class="affirmation-card" onclick="event.stopPropagation()">
    <span class="affirmation-emoji" id="aff-emoji">üíß</span>
    <div class="affirmation-points" id="aff-points">+1 point!</div>
    <div class="affirmation-text" id="aff-text">Stay hydrated!</div>
    <div class="affirmation-sub" id="aff-sub">Keep it up!</div>
    <button class="btn btn-primary" onclick="closeAffirmation()" style="max-width:200px">Awesome! üéâ</button>
  </div>
</div>

<script>
// ‚îÄ‚îÄ‚îÄ Data Layer ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

const AFFIRMATIONS = [
  { emoji: 'üíß', text: "You're absolutely crushing it!", sub: "Your body is glowing with gratitude." },
  { emoji: 'üåä', text: "Wave after wave of greatness!", sub: "Hydration is your superpower." },
  { emoji: '‚ú®', text: "Sparkling from the inside out!", sub: "You make drinking water look cool." },
  { emoji: 'üê≥', text: "Big splash energy today!", sub: "Ocean-level dedication right here." },
  { emoji: 'üåø', text: "Growing stronger every sip!", sub: "Plants respect you. Deeply." },
  { emoji: 'üèÜ', text: "A hydration champion is born!", sub: "Future you says: THANK YOU." },
  { emoji: '‚ö°', text: "Electrically hydrated!", sub: "You're practically glowing." },
  { emoji: 'üéØ', text: "Bullseye on that H‚ÇÇO!", sub: "Precision hydration. Respect." },
  { emoji: 'üåü', text: "You absolute STAR!", sub: "Even stars need water. Probably." },
  { emoji: 'ü¶à', text: "Shark mode: ACTIVATED!", sub: "Always moving, always hydrated." },
  { emoji: 'üçÄ', text: "Lucky to have you hydrating!", sub: "Today just got a whole lot better." },
  { emoji: 'üöÄ', text: "To the moon and hydrated!", sub: "Your body thanks you for fueling up." },
  { emoji: 'üåà', text: "Sip sip hooray!", sub: "Every drop counts toward greatness." },
  { emoji: 'ü¶Å', text: "Lion energy. Hydrated edition.", sub: "The jungle bows to your discipline." },
  { emoji: 'üî•', text: "On fire AND hydrated?!", sub: "That's the dream. That's YOU." },
  { emoji: 'üßä', text: "Cool, calm, and hydrated.", sub: "Unshakeable. Unstoppable. Wet." },
  { emoji: 'üå∫', text: "Blooming with every sip!", sub: "Flowers wish they drank like you." },
  { emoji: 'üê¨', text: "Dolphin vibes all day!", sub: "Smart, sleek, and soaking it in." },
  { emoji: 'üíé', text: "Diamond-level hydration!", sub: "Rare. Precious. Absolutely iconic." },
  { emoji: 'üé∏', text: "Rocking that water intake!", sub: "Your cells are headbanging with joy." },
  { emoji: 'üß†', text: "Big brain energy activated!", sub: "75% water. You're basically genius juice." },
  { emoji: 'üèÑ', text: "Riding the hydration wave!", sub: "Hang loose and stay watered." },
  { emoji: 'ü¶ã', text: "Transforming one sip at a time!", sub: "Glow up in progress. Drink up." },
  { emoji: 'üåô', text: "Even the moon pulls tides for you.", sub: "Water bends to your will." },
  { emoji: 'üçâ', text: "92% water. Just like you!", sub: "You and watermelon are basically twins." },
  { emoji: 'üêâ', text: "Dragon energy, water edition.", sub: "Mythically hydrated. Legendary status." },
  { emoji: 'üé™', text: "The main event: YOU drinking water!", sub: "Standing ovation from your kidneys." },
  { emoji: 'üåç', text: "You're 70% water now.", sub: "Congratulations, you're basically Earth." },
  { emoji: 'ü¶Ö', text: "Soaring on hydration wings!", sub: "Eagles don't skip water. Neither do you." },
  { emoji: 'üé≠', text: "Plot twist: you're THRIVING!", sub: "The hero always stays hydrated." },
  { emoji: 'üçã', text: "When life gives you water, drink it!", sub: "Zesty, refreshed, unstoppable." },
  { emoji: 'üåä', text: "You ARE the ocean.", sub: "Deep, powerful, and wonderfully wet." },
  { emoji: 'üèãÔ∏è', text: "Hydration gains unlocked!", sub: "Water is the original performance enhancer." },
  { emoji: 'üß≤', text: "Attracting good vibes and great health!", sub: "Hydration magnetism is real." },
  { emoji: 'ü™ê', text: "Planetary-level hydration!", sub: "Saturn has rings. You have water goals." },
  { emoji: 'üé®', text: "Painting your health masterpiece!", sub: "Every sip is a brushstroke of genius." },
  { emoji: 'ü¶Ñ', text: "Mythically hydrated!", sub: "Unicorns drink water. Now you know." },
  { emoji: 'üå§Ô∏è', text: "Every cloud has a silver lining.", sub: "Yours is filled with water. Drink up." },
  { emoji: 'üß¨', text: "DNA-level hydration!", sub: "Your cells just sent a thank-you note." },
  { emoji: 'üéØ', text: "Locked in. Locked on. Hydrated.", sub: "Nothing can stop you now." },
];

function getStorage() {
  try { return JSON.parse(localStorage.getItem('hydropals') || 'null'); }
  catch { return null; }
}

function setStorage(data) {
  localStorage.setItem('hydropals', JSON.stringify(data));
}

function today() {
  return new Date().toISOString().slice(0, 10);
}

function initUser(name, inviterCode, dailyGoal) {
  const userId = Math.random().toString(36).slice(2, 10);
  const data = {
    userId,
    name,
    points: 0,
    totalDrinks: 0,
    drinks: {}, // { 'YYYY-MM-DD': count }
    streak: 0,
    bestStreak: 0,
    dailyGoal: dailyGoal || 6,
    friends: [], // [{userId, name, points, totalDrinks, drinks, streak, lastSeen}]
    inviterCode: inviterCode || null,
    joinedAt: Date.now(),
  };
  setStorage(data);
  return data;
}

function getUserCode(data) {
  return btoa(JSON.stringify({
    userId: data.userId,
    name: data.name,
    points: data.points || 0,
    streak: data.streak || 0,
    totalDrinks: data.totalDrinks || 0,
  }));
}

function parseCode(code) {
  try { return JSON.parse(atob(code)); }
  catch { return null; }
}

// ‚îÄ‚îÄ‚îÄ Init ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

let APP = null;

window.addEventListener('load', () => {
  createBubbles();
  
  const params = new URLSearchParams(location.search);
  const inviteCode = params.get('invite');
  
  APP = getStorage();

  if (APP) {
    // Already have an account
    if (inviteCode) {
      // Accept new friend
      const info = parseCode(inviteCode);
      addFriendFromCode(inviteCode);
      showMain(info ? info.name : null);
    } else {
      showMain();
    }
  } else if (inviteCode) {
    // New user joining via invite
    const inviter = parseCode(inviteCode);
    if (inviter) {
      document.getElementById('join-inviter-name').textContent = inviter.name;
      document.getElementById('join-name').value = '';
      showScreen('join');
      document.getElementById('screen-join').dataset.inviteCode = inviteCode;
    } else {
      showScreen('setup');
    }
  } else {
    showScreen('setup');
  }
});

function showScreen(name) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-' + name).classList.add('active');
}

// ‚îÄ‚îÄ‚îÄ Setup ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function setupUser() {
  const name = document.getElementById('setup-name').value.trim();
  if (!name) { document.getElementById('setup-name').focus(); return; }
  const goalBtn = document.querySelector('#setup-goal-picker .goal-opt.active');
  const goal = goalBtn ? parseInt(goalBtn.dataset.val) : 6;
  APP = initUser(name, null, goal);
  setStorage(APP);
  showMain();
}

function joinUser() {
  const name = document.getElementById('join-name').value.trim();
  if (!name) { document.getElementById('join-name').focus(); return; }
  const goalBtn = document.querySelector('#join-goal-picker .goal-opt.active');
  const goal = goalBtn ? parseInt(goalBtn.dataset.val) : 6;
  const inviteCode = document.getElementById('screen-join').dataset.inviteCode;
  APP = initUser(name, inviteCode, goal);
  // Add the inviter as a friend immediately on joiner's side
  addFriendFromCode(inviteCode, true);
  setStorage(APP);
  // Show return link so inviter can add joiner back
  showMain();
  // Switch to friends tab and show the return link
  setTimeout(() => {
    showReturnLinkBanner(inviteCode);
  }, 500);
}

function showReturnLinkBanner(inviterCode) {
  // Generate a link the inviter clicks to add the new joiner
  const myCode = getUserCode(APP);
  const base = location.origin + location.pathname;
  const returnLink = `${base}?invite=${myCode}`;

  const inviterInfo = parseCode(inviterCode);
  const inviterName = inviterInfo ? inviterInfo.name : 'your friend';

  // Show a prominent banner
  let banner = document.getElementById('return-banner');
  if (!banner) {
    banner = document.createElement('div');
    banner.id = 'return-banner';
    banner.style.cssText = `
      background: linear-gradient(135deg, rgba(0,229,195,0.15), rgba(56,182,255,0.1));
      border: 1px solid rgba(0,229,195,0.4);
      border-radius: 18px;
      padding: 16px;
      margin-bottom: 16px;
    `;
    const friendsCard = document.querySelector('#tab-friends .card');
    if (friendsCard) friendsCard.parentNode.insertBefore(banner, friendsCard);
  }
  banner.innerHTML = `
    <div style="font-size:0.75rem;text-transform:uppercase;letter-spacing:1px;color:var(--mint);font-weight:700;margin-bottom:8px">üëã One more step!</div>
    <div style="font-size:0.9rem;color:var(--foam);margin-bottom:12px">Send <strong>${inviterName}</strong> this link so they can add you to their crew too:</div>
    <div style="display:flex;gap:8px">
      <div style="flex:1;background:rgba(255,255,255,0.06);border:1px solid rgba(56,182,255,0.2);border-radius:10px;padding:10px;font-size:0.7rem;font-family:monospace;color:var(--foam);word-break:break-all">${returnLink}</div>
      <button onclick="navigator.clipboard.writeText('${returnLink}').then(()=>{this.textContent='‚úÖ';setTimeout(()=>this.textContent='Copy',2000)})" style="background:rgba(0,229,195,0.2);border:1px solid rgba(0,229,195,0.4);border-radius:10px;color:var(--mint);font-weight:700;padding:10px 12px;cursor:pointer;font-family:'Nunito',sans-serif;white-space:nowrap">Copy</button>
    </div>
    <div style="font-size:0.75rem;color:var(--foam);opacity:0.5;margin-top:8px">When they open it, you'll both appear in each other's crew ‚úÖ</div>
  `;

  // Switch to friends tab
  document.querySelectorAll('.tab-content').forEach(t => t.style.display = 'none');
  document.getElementById('tab-friends').style.display = 'block';
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.nav-btn')[2].classList.add('active');
}

function addFriendFromCode(code, skipSave) {
  const info = parseCode(code);
  if (!info || !APP) return;
  if (info.userId === APP.userId) return;
  if (APP.friends.find(f => f.userId === info.userId)) {
    // Update existing friend's data if newer
    const existing = APP.friends.find(f => f.userId === info.userId);
    if (info.points > (existing.points || 0)) existing.points = info.points;
    if (info.streak > (existing.streak || 0)) existing.streak = info.streak;
    if (!skipSave) setStorage(APP);
    return;
  }
  APP.friends.push({
    userId: info.userId,
    name: info.name,
    points: info.points || 0,
    totalDrinks: info.totalDrinks || 0,
    drinks: {},
    streak: info.streak || 0,
    lastSeen: Date.now(),
  });
  if (!skipSave) setStorage(APP);
}

// ‚îÄ‚îÄ‚îÄ Main UI ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function showMain(newFriendName) {
  showScreen('main');
  document.getElementById('main-nav').style.display = 'flex';
  refreshUI();
  initNotifUI();
  scheduleNotifications();
  // Clean URL
  if (location.search) history.replaceState({}, '', location.pathname);
  // Show toast if new friend was added
  if (newFriendName) showToast(`ü§ù ${newFriendName} added to your crew!`);
}

function showToast(msg) {
  let toast = document.getElementById('toast');
  if (!toast) {
    toast = document.createElement('div');
    toast.id = 'toast';
    toast.style.cssText = `position:fixed;bottom:80px;left:50%;transform:translateX(-50%);background:linear-gradient(135deg,var(--wave),var(--sky));color:white;padding:12px 20px;border-radius:50px;font-weight:700;font-size:0.9rem;z-index:300;white-space:nowrap;box-shadow:0 8px 24px rgba(0,0,0,0.3);transition:opacity 0.4s`;
    document.body.appendChild(toast);
  }
  toast.textContent = msg;
  toast.style.opacity = '1';
  setTimeout(() => toast.style.opacity = '0', 3000);
}

function refreshUI() {
  if (!APP) return;
  const todayStr = today();

  // Name & points
  document.getElementById('display-name').textContent = APP.name;
  document.getElementById('display-points').textContent = APP.points;

  // Checked today?
  const todayCount = APP.drinks[todayStr] || 0;
  const goal = APP.dailyGoal || 6;
  const goalMet = todayCount >= goal;
  const drinkBtn = document.getElementById('drink-btn');
  const drinkBtnLabel = document.getElementById('drink-btn-label');
  const drinkStatus = document.getElementById('drink-status');
  const goalHint = document.getElementById('goal-hint');

  // Progress ring
  const ring = document.getElementById('progress-ring-fill');
  const circumference = 527.8;
  const pct = Math.min(todayCount / goal, 1);
  ring.style.strokeDashoffset = circumference - pct * circumference;
  ring.classList.toggle('goal-done', goalMet);

  if (goalMet) {
    drinkBtn.classList.add('checked-today');
    document.getElementById('drink-btn-icon').textContent = '‚úÖ';
    drinkBtnLabel.textContent = 'GOAL MET!';
    drinkStatus.textContent = `${todayCount} / ${goal} glasses today üéâ`;
    goalHint.textContent = 'Tap again to log more';
  } else {
    drinkBtn.classList.remove('checked-today');
    document.getElementById('drink-btn-icon').textContent = 'üíß';
    drinkBtnLabel.textContent = 'LOG DRINK';
    drinkStatus.textContent = `${todayCount} / ${goal} glasses today`;
    goalHint.textContent = `${goal - todayCount} more to hit your goal!`;
  }

  // Settings tab
  const settingsGoalVal = document.getElementById('settings-goal-val');
  if (settingsGoalVal) settingsGoalVal.textContent = goal;
  const settingsName = document.getElementById('settings-name-display');
  if (settingsName) settingsName.textContent = APP.name;
  // Sync active button in settings picker
  document.querySelectorAll('#settings-goal-picker .goal-opt').forEach(b => {
    b.classList.toggle('active', parseInt(b.dataset.val) === goal);
  });

  // Streak / month
  renderMonth();
  renderWeekChart();
  renderStats();
  renderFriends();
  renderInviteLink();
}

function renderMonth() {
  const now = new Date();
  const todayStr = today();
  const goal = APP.dailyGoal || 6;
  const grid = document.getElementById('month-grid');
  grid.innerHTML = '';

  // Day headers
  ['S','M','T','W','T','F','S'].forEach(d => {
    const h = document.createElement('div');
    h.className = 'month-day-header';
    h.textContent = d;
    grid.appendChild(h);
  });

  // Get first day of month and days in month
  const firstDay = new Date(now.getFullYear(), now.getMonth(), 1);
  const daysInMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();
  const startDow = firstDay.getDay();

  // Empty cells before first day
  for (let i = 0; i < startDow; i++) {
    const empty = document.createElement('div');
    grid.appendChild(empty);
  }

  // Day cells
  for (let d = 1; d <= daysInMonth; d++) {
    const dateStr = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
    const count = APP.drinks[dateStr] || 0;
    const isToday = dateStr === todayStr;
    const isFuture = dateStr > todayStr;
    const metGoal = count >= goal;

    const cell = document.createElement('div');
    cell.className = 'month-day' +
      (metGoal ? ' filled' : '') +
      (isToday ? ' today' : '') +
      (isFuture ? ' future' : '');
    cell.textContent = d;
    cell.title = `${dateStr}: ${count} glass${count !== 1 ? 'es' : ''}`;
    grid.appendChild(cell);
  }

  // Streak label
  const streak = calcStreak();
  const streakText = streak > 0
    ? `üî• ${streak} day${streak !== 1 ? 's' : ''}`
    : 'Start your streak!';
  document.getElementById('streak-label').textContent = streakText;
}

function calcStreak() {
  const now = new Date();
  const goal = APP.dailyGoal || 6;
  let streak = 0;
  for (let i = 0; i < 365; i++) {
    const d = new Date(now);
    d.setDate(d.getDate() - i);
    const ds = d.toISOString().slice(0,10);
    if ((APP.drinks[ds] || 0) >= goal) streak++;
    else break;
  }
  return streak;
}

function renderWeekChart() {
  const days = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
  const now = new Date();
  const todayStr = today();
  const chart = document.getElementById('week-chart');
  chart.innerHTML = '';

  const last7 = [];
  for (let i = 6; i >= 0; i--) {
    const d = new Date(now);
    d.setDate(d.getDate() - i);
    last7.push(d.toISOString().slice(0,10));
  }

  const max = Math.max(1, ...last7.map(d => APP.drinks[d] || 0));

  last7.forEach(dateStr => {
    const d = new Date(dateStr);
    const count = APP.drinks[dateStr] || 0;
    const isToday = dateStr === todayStr;
    const pct = count / max;

    const wrap = document.createElement('div');
    wrap.className = 'day-bar-wrap';

    const bar = document.createElement('div');
    bar.className = 'day-bar' + (count > 0 ? (isToday ? ' today-bar' : ' has-data') : '');
    bar.style.height = (pct * 70 + (count > 0 ? 6 : 4)) + 'px';

    const label = document.createElement('div');
    label.className = 'day-label' + (isToday ? ' today-label' : '');
    label.textContent = days[d.getDay()].charAt(0);

    wrap.appendChild(bar);
    wrap.appendChild(label);
    chart.appendChild(wrap);
  });
}

function renderStats() {
  document.getElementById('stat-total-pts').textContent = APP.points;
  document.getElementById('stat-total-drinks').textContent = APP.totalDrinks || 0;
  const cur = calcStreak();
  const best = Math.max(APP.bestStreak || 0, cur);
  APP.bestStreak = best;
  document.getElementById('stat-best-streak').textContent = best + ' day' + (best !== 1 ? 's' : '');
  document.getElementById('stat-cur-streak').textContent = cur + ' day' + (cur !== 1 ? 's' : '');
}

function renderFriends() {
  const list = document.getElementById('friends-list');
  const todayStr = today();

  // Combine self + friends for leaderboard
  const all = [
    { name: APP.name + ' (you)', points: APP.points, streak: calcStreak(), checkedToday: !!(APP.drinks[todayStr]), isMe: true },
    ...APP.friends.map(f => ({
      name: f.name,
      points: f.points,
      streak: f.streak || 0,
      checkedToday: !!(f.drinks && f.drinks[todayStr]),
      isMe: false
    }))
  ].sort((a, b) => b.points - a.points);

  if (all.length <= 1) {
    list.innerHTML = '<div class="empty-friends">Invite a friend to start competing! üëÜ</div>';
    return;
  }

  list.innerHTML = '';
  const emojis = ['ü•á','ü•à','ü•â','4Ô∏è‚É£','5Ô∏è‚É£','6Ô∏è‚É£','7Ô∏è‚É£','8Ô∏è‚É£','9Ô∏è‚É£','üîü'];
  all.forEach((f, i) => {
    const row = document.createElement('div');
    row.className = 'friend-row';
    if (f.isMe) row.style.borderColor = 'rgba(56,182,255,0.35)';
    row.innerHTML = `
      <div class="friend-avatar">${emojis[i] || 'üíß'}</div>
      <div style="flex:1">
        <div class="friend-name">${f.name}</div>
        <div class="friend-streak">üî• ${f.streak} day${f.streak !== 1 ? 's' : ''}</div>
      </div>
      <div style="text-align:right">
        <div class="friend-pts">‚≠ê ${f.points}</div>
        <div style="font-size:0.8rem;margin-top:2px">${f.checkedToday ? '‚úÖ today' : '‚è≥ pending'}</div>
      </div>
    `;
    list.appendChild(row);
  });
}

function renderInviteLink() {
  const code = getUserCode(APP); // always fresh ‚Äî includes current points/streak
  const base = location.origin + location.pathname;
  const link = `${base}?invite=${code}`;
  document.getElementById('invite-link-display').textContent = link;
  document.getElementById('invite-link-display').dataset.link = link;
}

// ‚îÄ‚îÄ‚îÄ Drink logging ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function logDrink() {
  if (!APP) return;
  const todayStr = today();
  const goal = APP.dailyGoal || 6;
  const prevCount = APP.drinks[todayStr] || 0;

  // Track drink
  APP.drinks[todayStr] = prevCount + 1;
  APP.totalDrinks = (APP.totalDrinks || 0) + 1;

  const newCount = APP.drinks[todayStr];
  const justMetGoal = newCount === goal;
  const pts = justMetGoal ? 2 : 1; // bonus point for hitting goal
  APP.points += pts;

  // Update streak
  const streak = calcStreak();
  APP.streak = streak;
  APP.bestStreak = Math.max(APP.bestStreak || 0, streak);

  setStorage(APP);

  // Show affirmation
  const aff = AFFIRMATIONS[Math.floor(Math.random() * AFFIRMATIONS.length)];
  showAffirmation(aff, pts, justMetGoal, newCount, goal);

  // Confetti on goal met or points milestone
  if (justMetGoal || APP.points % 10 === 0) launchConfetti();

  refreshUI();
}

function showAffirmation(aff, pts, justMetGoal, count, goal) {
  document.getElementById('aff-emoji').textContent = justMetGoal ? 'üèÜ' : aff.emoji;
  document.getElementById('aff-points').textContent = `+${pts} point${pts !== 1 ? 's' : ''}!`;
  document.getElementById('aff-text').textContent = justMetGoal
    ? `GOAL SMASHED! ${count}/${goal} glasses! üéØ`
    : aff.text;
  document.getElementById('aff-sub').textContent = justMetGoal
    ? `Streak: üî• ${calcStreak()} day${calcStreak() !== 1 ? 's' : ''} ‚Äî you're on fire!`
    : `${count}/${goal} glasses ‚Äî ${goal - count > 0 ? (goal - count) + ' to go!' : 'keep it up!'}`;
  document.getElementById('affirmation-overlay').classList.add('show');
}

function closeAffirmation() {
  document.getElementById('affirmation-overlay').classList.remove('show');
}

// ‚îÄ‚îÄ‚îÄ Goal selection ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function selectGoal(btn) {
  // Deactivate siblings in same picker
  const picker = btn.closest('.goal-picker');
  picker.querySelectorAll('.goal-opt').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');

  // If we're in settings, save immediately
  if (picker.id === 'settings-goal-picker' && APP) {
    APP.dailyGoal = parseInt(btn.dataset.val);
    setStorage(APP);
    refreshUI();
  }
}

// ‚îÄ‚îÄ‚îÄ Navigation ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function showTab(name, btn) {
  document.querySelectorAll('.tab-content').forEach(t => t.style.display = 'none');
  document.getElementById('tab-' + name).style.display = 'block';
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  refreshUI();
  if (name === 'settings') initNotifUI();
}

// ‚îÄ‚îÄ‚îÄ Invite ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function copyInviteLink() {
  const link = document.getElementById('invite-link-display').dataset.link;
  navigator.clipboard.writeText(link).then(() => {
    const btn = document.getElementById('copy-btn');
    btn.textContent = 'Copied!';
    setTimeout(() => btn.textContent = 'Copy', 2000);
  });
}

function shareInvite() {
  const link = document.getElementById('invite-link-display').dataset.link;
  if (navigator.share) {
    navigator.share({
      title: 'Join me on HydroPals! üíß',
      text: `${APP.name} is inviting you to track your water intake together on HydroPals!`,
      url: link,
    });
  } else {
    copyInviteLink();
  }
}

// ‚îÄ‚îÄ‚îÄ Notifications ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

const SW_CODE = `
self.addEventListener('message', (e) => {
  if (e.data.type === 'SCHEDULE') {
    const { times, name, goal, drinks } = e.data;
    const msgs = [
      { title: 'üíß Morning Hydration!', body: 'Start your day with a glass of water üåÖ' },
      { title: 'üíß Afternoon Check-in!', body: "Don't forget your midday water üå§Ô∏è" },
      { title: 'üíß Evening Reminder!', body: 'Almost done for the day! Log your evening drink üåô' },
    ];
    if (self._timers) self._timers.forEach(t => clearTimeout(t));
    self._timers = [];
    times.forEach((timeStr, i) => {
      if (!timeStr) return;
      const [h, m] = timeStr.split(':').map(Number);
      const now = new Date();
      const target = new Date();
      target.setHours(h, m, 0, 0);
      if (target <= now) target.setDate(target.getDate() + 1);
      const delay = target - now;
      const t = setTimeout(() => {
        self.registration.showNotification(msgs[i].title, {
          body: name + '! ' + msgs[i].body,
          icon: 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üíß</text></svg>',
        });
      }, delay);
      self._timers.push(t);
    });
  }
});
`;

let swReg = null;

async function registerSW() {
  if (!('serviceWorker' in navigator)) return null;
  try {
    const blob = new Blob([SW_CODE], { type: 'application/javascript' });
    const swUrl = URL.createObjectURL(blob);
    swReg = await navigator.serviceWorker.register(swUrl, { scope: '/' });
    return swReg;
  } catch(e) {
    // Blob SW not supported (e.g. Firefox) ‚Äî fall back to in-page timers
    return null;
  }
}

function initNotifUI() {
  if (!APP) return;
  const notifOn = APP.notificationsEnabled || false;
  const toggle = document.getElementById('notif-toggle');
  if (toggle) {
    toggle.checked = notifOn;
    document.getElementById('notif-time-section').style.display = notifOn ? 'block' : 'none';
  }
  if (APP.notifTimes) {
    const times = APP.notifTimes;
    if (times[0]) document.getElementById('notif-time-1').value = times[0];
    if (times[1]) document.getElementById('notif-time-2').value = times[1];
    if (times[2]) document.getElementById('notif-time-3').value = times[2];
  }
  // Show current permission state
  if ('Notification' in window && Notification.permission === 'denied') {
    const statusEl = document.getElementById('notif-status');
    statusEl.style.display = 'block';
    statusEl.style.color = 'var(--coral)';
    statusEl.textContent = '‚ùå Notifications blocked in browser settings. Go to site settings to allow them.';
    if (toggle) toggle.checked = false;
  }
}

async function toggleNotifications(checkbox) {
  const statusEl = document.getElementById('notif-status');
  const timeSection = document.getElementById('notif-time-section');

  if (!('Notification' in window)) {
    statusEl.style.display = 'block';
    statusEl.style.color = 'var(--coral)';
    statusEl.textContent = '‚ö†Ô∏è Your browser doesn\'t support notifications.';
    checkbox.checked = false;
    return;
  }

  if (checkbox.checked) {
    let permission = Notification.permission;
    if (permission === 'default') {
      permission = await Notification.requestPermission();
    }
    if (permission === 'granted') {
      APP.notificationsEnabled = true;
      timeSection.style.display = 'block';
      statusEl.style.display = 'block';
      statusEl.style.color = 'var(--mint)';
      statusEl.textContent = '‚úÖ Reminders on! Keep this tab open for best results.';
      saveNotifTimes();
      // Send a test notification
      setTimeout(() => {
        new Notification('üíß HydroPals', { body: `Hey ${APP.name}! Reminders are now active üéâ` });
      }, 500);
    } else if (permission === 'denied') {
      checkbox.checked = false;
      APP.notificationsEnabled = false;
      timeSection.style.display = 'none';
      statusEl.style.display = 'block';
      statusEl.style.color = 'var(--coral)';
      statusEl.textContent = '‚ùå Blocked! Click the üîí lock icon in your browser address bar ‚Üí Site settings ‚Üí Allow notifications.';
    }
  } else {
    APP.notificationsEnabled = false;
    timeSection.style.display = 'none';
    statusEl.style.display = 'none';
  }
  setStorage(APP);
}

function saveNotifTimes() {
  if (!APP) return;
  APP.notifTimes = [
    document.getElementById('notif-time-1').value,
    document.getElementById('notif-time-2').value,
    document.getElementById('notif-time-3').value,
  ];
  setStorage(APP);
  scheduleNotifications();
}

function scheduleNotifications() {
  if (!APP || !APP.notificationsEnabled || Notification.permission !== 'granted') return;
  const times = APP.notifTimes || ['09:00', '14:00', '19:00'];

  // Clear old timers
  if (window._notifTimers) window._notifTimers.forEach(t => clearTimeout(t));
  window._notifTimers = [];

  const msgs = [
    { title: 'üíß Morning Hydration!', body: `Good morning ${APP.name}! Start your day with water üåÖ` },
    { title: 'üíß Afternoon Check-in!', body: `Hey ${APP.name}! Midday water time üå§Ô∏è` },
    { title: 'üíß Evening Reminder!', body: `Almost there ${APP.name}! Log your evening drink üåô` },
  ];

  times.forEach((timeStr, i) => {
    if (!timeStr) return;
    const [h, m] = timeStr.split(':').map(Number);
    const now = new Date();
    const target = new Date();
    target.setHours(h, m, 0, 0);
    if (target <= now) target.setDate(target.getDate() + 1);
    const delay = target - now;

    const timer = setTimeout(() => {
      const todayCount = APP ? (APP.drinks[today()] || 0) : 0;
      const goal = APP ? (APP.dailyGoal || 6) : 6;
      if (todayCount < goal) {
        try {
          new Notification(msgs[i].title, {
            body: msgs[i].body + ` (${todayCount}/${goal} glasses so far)`,
            icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">üíß</text></svg>',
          });
        } catch(e) {}
      }
      // Reschedule for next day
      scheduleNotifications();
    }, delay);

    window._notifTimers.push(timer);
  });
}

// ‚îÄ‚îÄ‚îÄ Confetti ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function launchConfetti() {
  const canvas = document.getElementById('confetti-canvas');
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  const pieces = Array.from({length: 80}, () => ({
    x: Math.random() * canvas.width,
    y: -10,
    r: Math.random() * 6 + 4,
    d: Math.random() * 80 + 20,
    color: ['#38b6ff','#00e5c3','#ffe066','#a8e6ff','#ff6b6b','#7fffea'][Math.floor(Math.random()*6)],
    tilt: Math.random() * 10 - 5,
    tiltAngle: 0,
    tiltSpeed: Math.random() * 0.1 + 0.05,
    vy: Math.random() * 3 + 2,
    vx: Math.random() * 2 - 1,
  }));

  let frame = 0;
  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    pieces.forEach(p => {
      ctx.beginPath();
      ctx.ellipse(p.x, p.y, p.r, p.r * 0.6, p.tilt, 0, Math.PI * 2);
      ctx.fillStyle = p.color;
      ctx.fill();
      p.y += p.vy;
      p.x += p.vx;
      p.tiltAngle += p.tiltSpeed;
      p.tilt = Math.sin(p.tiltAngle) * 12;
    });
    frame++;
    if (frame < 120) requestAnimationFrame(draw);
    else ctx.clearRect(0, 0, canvas.width, canvas.height);
  }
  draw();
}

// ‚îÄ‚îÄ‚îÄ Ambient Bubbles ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

function createBubbles() {
  const container = document.getElementById('bubbles');
  for (let i = 0; i < 12; i++) {
    const b = document.createElement('div');
    b.className = 'bubble';
    const size = Math.random() * 40 + 10;
    b.style.cssText = `
      width: ${size}px; height: ${size}px;
      left: ${Math.random() * 100}%;
      animation-duration: ${Math.random() * 15 + 10}s;
      animation-delay: ${Math.random() * 10}s;
    `;
    container.appendChild(b);
  }
}
</script>
</body>
</html>
